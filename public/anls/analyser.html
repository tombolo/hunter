<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Signals Dashboard</title>
    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;
            text-align: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        button {
            padding: 10px 20px;
            background-color: #ff5722;
            border: none;
            color: #212121;
            cursor: pointer;
            font-size: 16px;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #e64a19;
        }

        .animated-text {
            font-size: 20px;
            color: #ffeb3b;
            margin-top: 20px;
        }

        .shaking-title {
            font-size: 30px;
            font-weight: bold;
            animation: shakeTitle 3s infinite, changeColor 5s infinite;
            margin-bottom: 20px;
        }

        @keyframes shakeTitle {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
        }

        @keyframes changeColor {
            0%, 100% { color: #ffeb3b; }
            25% { color: #4caf50; }
            50% { color: #f44336; }
            75% { color: #ffeb3b; }
        }

        select {
            padding: 10px;
            font-size: 16px;
            background-color: #333;
            color: #e0e0e0;
            border: 1px solid #444;
            border-radius: 5px;
            margin: 20px;
        }

        table {
            width: 60%;
            margin: 20px auto;
            border-collapse: collapse;
            background-color: #1e1e1e;
            color: #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            border: 1px solid #444;
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: #ff5722;
        }

        .digit-display-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            max-width: 80%;
            margin: 10px auto;
            border: 1px solid #444;
            padding: 10px;
            overflow: hidden;
            background-color: #2c2c2c;
            border-radius: 8px;
        }

        .digit {
            font-size: 18px;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            margin: 2px;
        }

        .even-digit {
            background-color: blue;
            color: white;
        }

        .odd-digit {
            background-color: green;
            color: white;
        }

        .over-digit {
            background-color: red;
            color: white;
        }

        .under-digit {
            background-color: blue;
            color: white;
        }
    </style>
</head>
<body>
    <h1 class="shaking-title" id="titleText"></h1>

    <p class="animated-text" id="typingText"></p>

    <!-- Volatility Market Dropdown -->
    <h2>Select Volatility Market</h2>
    <select id="volatilityMarket">
        <option value="R_10">Volatility 10 Index</option>
        <option value="R_25">Volatility 25 Index</option>
        <option value="R_50">Volatility 50 Index</option>
        <option value="R_75">Volatility 75 Index</option>
        <option value="R_100">Volatility 100 Index</option>
        <option value="R_200">Volatility 200 Index</option>
        <option value="R_300">Volatility 300 Index</option>
        <option value="R_10_1s">Volatility 10 (1s) Index</option>
        <option value="R_25_1s">Volatility 25 (1s) Index</option>
        <option value="R_50_1s">Volatility 50 (1s) Index</option>
        <option value="R_75_1s">Volatility 75 (1s) Index</option>
        <option value="R_100_1s">Volatility 100 (1s) Index</option>
    </select>

    <!-- Even/Odd Analysis Table -->
    <h2>Even Odd Analyser</h2>
    <div id="digitDisplayEvenOdd" class="digit-display-container"></div>
    <table id="evenOddTable">
        <thead>
            <tr>
                <th colspan="3">Even Odd Analyser</th>
            </tr>
            <tr>
                <th>Market</th>
                <th>Even</th>
                <th>Odd</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td id="bestEvenOddMarket">Best Market</td>
                <td id="evenMarket">Loading...</td>
                <td id="oddMarket">Loading...</td>
            </tr>
        </tbody>
    </table>

    <!-- Over/Under Analysis Table -->
    <h2>Over and Under Analyser</h2>
    <div id="digitDisplayOverUnder" class="digit-display-container"></div>
    <table id="overUnderTable">
        <thead>
            <tr>
                <th colspan="3">Over and Under Analyser</th>
            </tr>
            <tr>
                <th>Market</th>
                <th>Over</th>
                <th>Under</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td id="bestOverUnderMarket">Best Market</td>
                <td id="overMarket">Loading...</td>
                <td id="underMarket">Loading...</td>
            </tr>
        </tbody>
    </table>

    <script>
        const titleTextElement = document.getElementById('titleText');
        const titleWords = ['', 'Market', 'Analyser'];
        let titleIndex = 0;

        function animateTitle() {
            if (titleIndex < titleWords.length) {
                titleTextElement.textContent += titleWords[titleIndex] + ' ';
                titleIndex++;
                setTimeout(animateTitle, 500);
            } else {
                setTimeout(() => {
                    titleTextElement.textContent = '';
                    titleIndex = 0;
                    animateTitle();
                }, 2000);
            }
        }

        animateTitle();

        const typingText = document.getElementById('typingText');
        const typingMessage = "Welcome to  Support System";
        let typingIndex = 0;

        function typeMessage() {
            if (typingIndex < typingMessage.length) {
                typingText.textContent += typingMessage.charAt(typingIndex);
                typingIndex++;
                setTimeout(typeMessage, 100);
            } else {
                setTimeout(() => {
                    typingText.textContent = '';
                    typingIndex = 0;
                    typeMessage();
                }, 2000);
            }
        }

        typeMessage();

        const appId = '63213'; // Replace with your actual app_id
        const ws = new WebSocket(`wss://ws.binaryws.com/websockets/v3?app_id=${appId}`);

        let evenCount = 0;
        let oddCount = 0;
        let overCount = 0;
        let underCount = 0;
        let digitCounts = Array(10).fill(0); // To store counts of each digit
        let startTime = new Date().getTime(); // Track start time for 15-minute interval
        const digitDisplayEvenOdd = document.getElementById('digitDisplayEvenOdd');
        const digitDisplayOverUnder = document.getElementById('digitDisplayOverUnder');

        const marketNames = {
            'R_10': 'Volatility 10 Index',
            'R_25': 'Volatility 25 Index',
            'R_50': 'Volatility 50 Index',
            'R_75': 'Volatility 75 Index',
            'R_100': 'Volatility 100 Index',
            'R_200': 'Volatility 200 Index',
            'R_300': 'Volatility 300 Index',
            'R_10_1s': 'Volatility 10 (1s) Index',
            'R_25_1s': 'Volatility 25 (1s) Index',
            'R_50_1s': 'Volatility 50 (1s) Index',
            'R_75_1s': 'Volatility 75 (1s) Index',
            'R_100_1s': 'Volatility 100 (1s) Index'
        };

        document.getElementById('volatilityMarket').addEventListener('change', function() {
            const selectedMarket = this.value;
            const marketName = marketNames[selectedMarket];
            document.getElementById('bestEvenOddMarket').textContent = marketName;
            document.getElementById('bestOverUnderMarket').textContent = marketName;
            subscribeToTicks(selectedMarket);
        });

        ws.onopen = function() {
            console.log('Connected to WebSocket');
            subscribeToTicks('R_50'); // Default market
        };

        ws.onmessage = function(event) {
            const data = JSON.parse(event.data);
            if (data.msg_type === 'tick') {
                updateData(data.tick.quote);
            }
        };

        ws.onerror = function(error) {
            console.error('WebSocket Error:', error);
        };

        ws.onclose = function() {
            console.log('WebSocket connection closed');
        };

        function subscribeToTicks(market) {
            ws.send(JSON.stringify({ ticks: market }));
        }

        function updateData(tickPrice) {
            const lastDigit = tickPrice.toString().slice(-1);
            const digit = parseInt(lastDigit);

            digitCounts[digit]++;
            const currentTime = new Date().getTime();

            if (digit % 2 === 0) {
                evenCount++;
                addDigit(digitDisplayEvenOdd, 'E', 'even-digit');
            } else {
                oddCount++;
                addDigit(digitDisplayEvenOdd, 'O', 'odd-digit');
            }

            if (digit >= 5) {
                overCount++;
                addDigit(digitDisplayOverUnder, 'O', 'over-digit');
            } else {
                underCount++;
                addDigit(digitDisplayOverUnder, 'U', 'under-digit');
            }

            if (currentTime - startTime >= 15 * 60 * 1000) {
                displayBestMarkets();
                evenCount = 0;
                oddCount = 0;
                overCount = 0;
                underCount = 0;
                digitCounts.fill(0);
                startTime = currentTime;
            }
        }

        function addDigit(container, label, className) {
            const digitElement = document.createElement('div');
            digitElement.textContent = label;
            digitElement.className = `digit ${className}`;
            container.appendChild(digitElement);
            if (container.children.length > 20) {
                container.removeChild(container.children[0]);
            }
        }

        function displayBestMarkets() {
            document.getElementById('evenMarket').textContent = evenCount;
            document.getElementById('oddMarket').textContent = oddCount;
            document.getElementById('overMarket').textContent = overCount;
            document.getElementById('underMarket').textContent = underCount;
        }
    </script>
</body>
</html>